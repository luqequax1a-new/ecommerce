import{a as Ce}from"./chunk-ZAIQRYHZ.js";import{a as xe,h as ye}from"./chunk-YQYUGJ54.js";import{a as ve}from"./chunk-2HZD26AN.js";import{a as ge}from"./chunk-WGB4JAKK.js";import{l as R,m as I}from"./chunk-NIGDHIPV.js";import{a as he,h as we}from"./chunk-OT7HV5IV.js";import{a as be}from"./chunk-54TP46UZ.js";import"./chunk-VPYJY44D.js";import"./chunk-WPAIU3ME.js";import"./chunk-KRRVKEPJ.js";import{a as ae}from"./chunk-MJTWR3JG.js";import"./chunk-SNSHKWVC.js";import"./chunk-DC4FYJ6D.js";import{a as se}from"./chunk-7RQBIUSJ.js";import{a as de,e as ce,f as pe,g as ue,h as me,i as _e,k as fe,l as O}from"./chunk-VO736VT2.js";import{d as ie}from"./chunk-XRXH52AL.js";import"./chunk-FH3MEI42.js";import{a as re}from"./chunk-SOFS53MN.js";import"./chunk-5I4ANEOW.js";import"./chunk-4CHXRQ3Z.js";import{a as oe}from"./chunk-ZEHU2A57.js";import{a as le}from"./chunk-HVORON4Y.js";import"./chunk-TQWQFZO7.js";import{f as ne}from"./chunk-ZBZRXBUQ.js";import{T as G,U as te,oa as v}from"./chunk-P74FXGQP.js";import{g as Y,h as Z,l as ee}from"./chunk-MWLJ7KQD.js";import"./chunk-Z5C4ODF3.js";import{c as E,d as F}from"./chunk-NFASJCFR.js";import{Ac as T,Dd as N,Ec as C,Hb as y,Ja as q,Jb as M,Kc as l,Lc as a,Ob as h,Oc as z,Pb as d,Qb as c,Rb as P,Yc as B,Zb as w,ab as r,ac as g,cc as p,fb as H,ja as m,jc as V,kc as $,nb as k,pc as S,qa as _,qc as b,ra as f,rc as W,sc as x,sd as J,tb as A,va as U,zd as X}from"./chunk-BJL3QR55.js";import{a as j,d as K}from"./chunk-4CLCTAJ7.js";var De=["downloadModal"],Ve=()=>[];function Be(n,s){if(n&1){let o=w();d(0,"div",1)(1,"h5",2),b(2),l(3,"translate"),c(),d(4,"div",3)(5,"select2",4),l(6,"translate"),l(7,"translate"),g("update",function(t){_(o);let i=p();return f(i.selectProduct(t))}),c()(),d(8,"div",5)(9,"app-button",6),g("click",function(){let t=_(o).$implicit;return f(t.dismiss("Cancel"))}),b(10),l(11,"translate"),c(),d(12,"app-button",7),g("click",function(){let t=_(o).$implicit,i=p();return f(i.download(t))}),b(13),l(14,"translate"),c()()()}if(n&2){let o=p();r(2),W(a(3,14,"download")),r(3),h("noResultMessage",T(a(6,16,"no_data_found")))("data",o.variations.length?o.variations:C(24,Ve))("placeholder",a(7,18,"select_product")),r(4),S("btn-md fw-bold btn btn-secondary"),h("spinner",!1)("id","no_btn"),r(),x(" ",a(11,20,"cancel")," "),r(2),S("btn-theme btn-md fw-bold btn"),h("id","yes_btn"),r(),x(" ",a(14,22,"download")," ")}}var Me=(()=>{let s=class s{constructor(){this.modalService=m(te),this.store=m(v),this.modalOpen=!1,this.variations=[],this.DownloadModal=B("downloadModal")}openModal(e){return K(this,null,function*(){this.modalOpen=!0,this.product=e,e.variations.length&&(this.variations=e.variations.filter(t=>t?.digital_files?.length).map(t=>({label:t?.name,value:t?.id}))),this.modalService.open(this.DownloadModal(),{ariaLabelledBy:"Download-Modal",centered:!0,windowClass:"theme-modal"}).result.then(t=>{`${t}`},t=>{this.closeResult=`Dismissed ${this.getDismissReason(t)}`})})}getDismissReason(e){return e===G.ESC?"by pressing ESC":e===G.BACKDROP_CLICK?"by clicking on a backdrop":`with: ${e}`}download(e){this.store.dispatch(new O({product_id:this.product.id,variation_id:this.variation_id})),e.close()}selectProduct(e){this.variation_id=+e.value}ngOnDestroy(){this.modalOpen&&this.modalService.dismissAll()}};s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=k({type:s,selectors:[["app-digital-download-modal"]],viewQuery:function(t,i){t&1&&V(i.DownloadModal,De,5),t&2&&$()},decls:2,vars:0,consts:[["downloadModal",""],[1,"modal-body"],[1,"modal-title","text-center"],[1,"mb-4","mt-2"],["resettable","",1,"custom-select",3,"update","data","placeholder","noResultMessage"],[1,"button-box"],[3,"click","spinner","id"],[3,"click","id"]],template:function(t,i){t&1&&A(0,Be,15,25,"ng-template",null,0,z)},dependencies:[F,I,R,le,E],encapsulation:2});let n=s;return n})();var ke=["csvModal"],Ae=["downloadModal"],$e=()=>["/product/create"],Q=()=>[];function Ee(n,s){if(n&1){let o=w();d(0,"div",10)(1,"a",11),g("click",function(){_(o);let t=p();return f(t.CSVModal().openModal())}),P(2,"i",12),b(3),l(4,"translate"),c(),d(5,"a",11),g("click",function(){_(o);let t=p();return f(t.export())}),P(6,"i",13),b(7),l(8,"translate"),c(),d(9,"a",14),P(10,"i",15),b(11),l(12,"translate"),c()()}n&2&&(r(3),x(" ",a(4,4,"import")," "),r(4),x(" ",a(8,6,"export")," "),r(2),h("routerLink",C(10,$e)),r(2),x(" ",a(12,8,"add_product")," "))}function Fe(n,s){if(n&1){let o=w();d(0,"select2",22),l(1,"translate"),l(2,"async"),l(3,"async"),l(4,"translate"),g("update",function(t){_(o);let i=p(3);return f(i.filters(t,"store_ids"))}),c()}if(n&2){let o,e=p(3);h("noResultMessage",T(a(1,4,"no_data_found")))("data",(o=a(2,6,e.store$))!=null&&o.length?a(3,8,e.store$):C(12,Q))("placeholder",a(4,10,"select_store"))}}function Re(n,s){if(n&1&&(d(0,"div",17),y(1,Fe,5,13,"select2",21),c()),n&2){let o=p(2);r(),M(o.isBrowser?1:-1)}}function Ie(n,s){if(n&1){let o=w();d(0,"select2",23),l(1,"translate"),l(2,"translate"),g("update",function(t){_(o);let i=p(2);return f(i.applyFilter(t))}),c()}if(n&2){let o=p(2);h("noResultMessage",T(a(1,4,"no_data_found")))("placeholder",a(2,6,"select_product_type"))("data",o.mainProductType.length?o.mainProductType:C(8,Q))}}function Oe(n,s){if(n&1){let o=w();d(0,"select2",22),l(1,"translate"),l(2,"async"),l(3,"async"),l(4,"translate"),g("update",function(t){_(o);let i=p(2);return f(i.filters(t,"brand_ids"))}),c()}if(n&2){let o,e=p(2);h("noResultMessage",T(a(1,4,"no_data_found")))("data",(o=a(2,6,e.brand$))!=null&&o.length?a(3,8,e.brand$):C(12,Q))("placeholder",a(4,10,"select_brands"))}}function Qe(n,s){if(n&1){let o=w();d(0,"div",8)(1,"div",16),y(2,Re,2,1,"div",17),l(3,"async"),l(4,"async"),d(5,"div"),l(6,"async"),l(7,"async"),y(8,Ie,3,9,"select2",18),c(),d(9,"div",19)(10,"app-advance-dropdown",20),l(11,"async"),l(12,"async"),g("selectedItem",function(t){_(o);let i=p();return f(i.selectItem(t))}),c()(),d(13,"div"),l(14,"async"),l(15,"async"),y(16,Oe,5,13,"select2",21),c()()()}if(n&2){let o,e,t,i,u=p();r(2),M(((o=a(3,11,u.user$))==null||o.role==null?null:o.role.name)!=="vendor"&&(!((o=a(4,13,u.setting$))==null||o.activation==null)&&o.activation.multivendor)?2:-1),r(3),S(((e=a(6,15,u.user$))==null||e.role==null?null:e.role.name)!=="vendor"&&(!((e=a(7,17,u.setting$))==null||e.activation==null)&&e.activation.multivendor)?"col-xl-2 col-lg-6 col-md-3 col-sm-6":"col-md-4"),r(3),M(u.isBrowser?8:-1),r(2),h("text","select_categories")("selectSingle",!1)("options",a(11,19,u.category$)?(t=a(12,21,u.category$))==null?null:t.data:C(27,Q))("subArrayKey","subcategories"),r(3),S(((i=a(14,23,u.user$))==null||i.role==null?null:i.role.name)!=="vendor"&&(!((i=a(15,25,u.setting$))==null||i.activation==null)&&i.activation.multivendor)?"col-xl-3 col-lg-6 col-md-3 col-sm-6":"col-md-4"),r(3),M(u.isBrowser?16:-1)}}var Ct=(()=>{let s=class s{constructor(){this.store=m(v),this.renderer=m(H),this.document=m(U),this.platformId=m(q),this.router=m(Y),this.product$=m(v).select(ve.product),this.setting$=m(v).select(ie.setting),this.category$=m(v).select(ge.category),this.brand$=m(v).select(ye.brands),this.store$=m(v).select(we.stores),this.user$=m(v).select(ne.user),this.CSVModal=B("csvModal"),this.DownloadModal=B("downloadModal"),this.mainProductType=[{value:"physical",label:"Physical Product"},{value:"digital",label:"Digital Product"},{value:"external",label:"External/Affiliate product"}],this.filter={search:"",field:"",category_ids:"",brand_ids:"",store_ids:"",sort:"",page:1,paginate:15},this.advanceFilter=[],this.open=!0,this.tableConfig={columns:[{title:"image",dataField:"product_thumbnail",class:"tbl-image",type:"image",placeholder:"assets/images/product.png"},{title:"name",dataField:"name",sortable:!0,sort_direction:"desc"},{title:"sku",dataField:"sku",sortable:!0,sort_direction:"desc"},{title:"price",dataField:"sale_price",type:"price",sortable:!0,sort_direction:"desc"},{title:"stock",dataField:"stock"},{title:"store",dataField:"store_name"},{title:"approved",dataField:"is_approved",type:"switch",canAllow:["admin"]},{title:"status",dataField:"status",type:"switch"}],rowActions:[{label:"Edit",actionToPerform:"edit",icon:"ri-pencil-line",permission:"product.edit"},{label:"Delete",actionToPerform:"delete",icon:"ri-delete-bin-line",permission:"product.destroy"},{label:"View",actionToPerform:"view",icon:"ri-eye-line"}],data:[],total:0};let e=this.platformId;this.isBrowser=N(e),this.setting$.subscribe(t=>{t&&t.general&&(this.url=t.general.site_url)})}ngOnInit(){this.store.dispatch(new se({status:1})),this.store.dispatch(new xe({status:1})),this.store.dispatch(new he({status:1})),this.product$.subscribe(e=>{let t=e?.data?.filter(i=>(i.stock=i.stock_status?`<div class="status-${i.stock_status}"><span>${i.stock_status.replace(/_/g," ")}</span></div>`:"-",i.store_name=i?.store?i?.store?.store_name:"-",i));this.tableConfig.data=e?t:[],this.tableConfig.total=e?e?.total:0})}onTableChange(e){this.filter=j(j({},this.filter),e),this.store.dispatch(new de(this.filter))}applyFilter(e){this.filter.product_type=e&&e.value?e.value:null,this.filter.product_type||delete this.filter.product_type,this.onTableChange(this.filter)}onActionClicked(e){e.actionToPerform=="edit"?this.edit(e.data):e.actionToPerform=="is_approved"?this.approve(e.data):e.actionToPerform=="status"?this.status(e.data):e.actionToPerform=="delete"?this.delete(e.data):e.actionToPerform=="deleteAll"?this.deleteAll(e.data):e.actionToPerform=="duplicate"?this.duplicate(e.data):e.actionToPerform=="download"?this.download(e.data):e.actionToPerform=="view"&&this.view(e.data)}edit(e){this.router.navigateByUrl(`/product/edit/${e.id}`)}approve(e){this.store.dispatch(new pe(e.id,e.is_approved))}status(e){this.store.dispatch(new ce(e.id,e.status))}delete(e){this.store.dispatch(new ue(e.id))}deleteAll(e){this.store.dispatch(new me(e))}duplicate(e){this.store.dispatch(new _e(e))}download(e){e?.variations?.length?this.DownloadModal().openModal(e):this.store.dispatch(new O({product_id:e.id,variation_id:null}))}view(e){N(this.platformId)&&window.open(this.url+"/product/"+e.slug,"_blank")}export(){this.store.dispatch(new fe(this.filter))}openFilter(){this.open=!this.open}selectItem(e){this.renderer.addClass(this.document.body,"loader-none"),Array.isArray(e)&&e.length?this.filter.category_ids=e.join():this.filter.category_ids=[],this.onTableChange(this.filter)}filters(e,t){this.renderer.addClass(this.document.body,"loader-none"),e&&e.value?this.filter[t]=e.value.join():this.filter[t]=[],this.onTableChange(this.filter)}};s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=k({type:s,selectors:[["app-product"]],viewQuery:function(t,i){t&1&&(V(i.CSVModal,ke,5),V(i.DownloadModal,Ae,5)),t&2&&$(2)},decls:11,vars:8,consts:[["csvModal",""],["downloadModal",""],[3,"gridClass","title"],["class","d-flex flex-wrap gap-3","button","",4,"hasPermission"],[3,"tableChanged","rowClicked","action","tableConfig","hasCheckbox","hasDuplicate"],["filter","",1,"top-panel-selection"],[1,"align-items-center","btn","d-flex","h-100","btn-light-bg","fs-5","px-3","py-1",3,"click"],[1,"ri-filter-3-line"],["advanceFilter","",1,"show-box","mb-4","d-block","product-category-option"],[3,"module"],["button","",1,"d-flex","flex-wrap","gap-3"],["href","javascript:void(0)",1,"align-items-center","btn","btn-light-bg",3,"click"],[1,"ri-upload-2-line"],[1,"ri-download-2-line"],[1,"align-items-center","btn","btn-theme","d-flex",3,"routerLink"],[1,"ri-add-line"],[1,"row","g-sm-4","g-3"],[1,"col-xl-3","col-lg-6","col-md-3","col-sm-6"],["resettable","",1,"custom-select",3,"placeholder","data","noResultMessage"],[1,"col-xl-4","col-lg-6","col-md-3","col-sm-6"],[3,"selectedItem","text","selectSingle","options","subArrayKey"],["multiple","true","resettable","",1,"custom-select",3,"data","placeholder","noResultMessage"],["multiple","true","resettable","",1,"custom-select",3,"update","data","placeholder","noResultMessage"],["resettable","",1,"custom-select",3,"update","placeholder","data","noResultMessage"]],template:function(t,i){if(t&1){let u=w();d(0,"app-page-wrapper",2),A(1,Ee,13,11,"div",3),d(2,"app-table",4),g("tableChanged",function(D){return _(u),f(i.onTableChange(D))})("rowClicked",function(D){return _(u),f(i.edit(D))})("action",function(D){return _(u),f(i.onActionClicked(D))}),d(3,"div",5)(4,"button",6),g("click",function(){return _(u),f(i.openFilter())}),P(5,"i",7),c()(),y(6,Qe,17,28,"div",8),c()(),P(7,"app-import-csv-modal",9,0)(9,"app-digital-download-modal",null,1)}t&2&&(h("gridClass","col-sm-12")("title","products"),r(),h("hasPermission","product.create"),r(),h("tableConfig",i.tableConfig)("hasCheckbox",!0)("hasDuplicate",!0),r(4),M(i.open?6:-1),r(),h("module","product"))},dependencies:[X,F,ee,Z,re,I,R,oe,ae,Ce,be,Me,J,E],encapsulation:2});let n=s;return n})();export{Ct as Product};
