import './polyfills.server.mjs';
import{a as y,b as be,c as ge,d as Ce}from"./chunk-7ZIMH7QJ.mjs";import{a as ve}from"./chunk-6VIZRZAF.mjs";import{a as he}from"./chunk-2SVZYLV7.mjs";import{a as fe}from"./chunk-22TZ6IH2.mjs";import{a as ue}from"./chunk-HSYTOS5X.mjs";import{a as pe}from"./chunk-65CLJ2AQ.mjs";import"./chunk-NHSJMIOE.mjs";import{d as re}from"./chunk-6TRN37HW.mjs";import{l as le,m as se}from"./chunk-636DULP5.mjs";import{a as _e}from"./chunk-725TIIX2.mjs";import"./chunk-UGRILRVZ.mjs";import"./chunk-HF4BIA72.mjs";import{a as de}from"./chunk-RXOQFJCA.mjs";import{a as me}from"./chunk-MD4PGILL.mjs";import"./chunk-36I6ZS5W.mjs";import{f as ce}from"./chunk-7WHNMFBW.mjs";import{A as te,B as ie,C as ne,d as z,e as W,g as J,h as K,k as F,m as X,n as Y,oa as f,q as Z,t as ee}from"./chunk-ZL7RZNVT.mjs";import"./chunk-JTNA5OIK.mjs";import"./chunk-D5OUPU4G.mjs";import{c as ae,d as oe}from"./chunk-XXCMIAG3.mjs";import{$b as R,Gc as N,Hd as U,Ka as I,Kc as D,Md as j,Nb as w,Pb as x,Qc as r,Rc as l,Td as H,Ub as a,Vb as d,Wb as c,Xb as C,Yd as L,ac as G,dc as S,dd as Q,eb as n,gc as v,ic as u,ja as p,jb as P,pc as O,qa as _,qc as q,ra as h,rb as $,rc as V,va as E,vc as M,wc as b,xb as k,xc as B,yc as T}from"./chunk-GYKPLZNJ.mjs";import"./chunk-S6KH3LOX.mjs";var we=["confirmationModal"],xe=()=>["vendor_wallet.credit","vendor_wallet.debit"],Se=()=>[];function Ve(o,m){if(o&1&&(C(0,"select2",14),r(1,"translate"),r(2,"async"),r(3,"async"),r(4,"translate")),o&2){let s,t=u(2);a("noResultMessage",N(l(1,4,"no_data_found")))("data",(s=l(2,6,t.users$))!=null&&s.length?l(3,8,t.users$):D(12,Se))("placeholder",l(4,10,"select_vendor"))}}function Me(o,m){if(o&1&&(d(0,"div",3)(1,"form",5)(2,"app-page-wrapper",6),w(3,Ve,5,13,"select2",14),c()()()),o&2){let s=u();n(),a("formGroup",s.form),n(),a("gridClass","col-sm-12")("title","select_vendor"),n(),x(s.isBrowser?3:-1)}}function Be(o,m){if(o&1){let s=S();R(0),C(1,"input",15,1),r(3,"translate"),d(4,"div",16)(5,"app-button",17),v("click",function(){_(s);let e=u();return h(e.form.valid&&e.ConfirmationModal().openModal("credit"))}),b(6),r(7,"translate"),c(),d(8,"app-button",18),v("click",function(){_(s);let e=V(2),i=u();return h(+i.balance<+e.value||!!e.value&&i.ConfirmationModal().openModal("debit"))}),b(9),r(10,"translate"),c()(),G()}if(o&2){let s=V(2),t=u();n(),a("placeholder",N(l(3,12,"add_withdraw_amount"))),n(4),M("btn btn-animation"),a("disabled",!t.form.valid)("spinner",!1),n(),T(" ",l(7,14,"add")," "),n(2),M("btn btn-light-bg"),a("spinner",!1)("disabled",+t.balance<+s.value||!s.value),n(),T(" ",l(10,16,"withdraw")," ")}}var Ye=(()=>{let m=class m{constructor(){this.document=p(E),this.renderer=p(P),this.store=p(f),this.formBuilder=p(te),this.users$=p(f).select(ve.users),this.setting$=p(f).select(re.setting),this.vendorWallet$=p(f).select(Ce.vendorWallet),this.roleName$=p(f).select(ce.getRoleName),this.ConfirmationModal=Q("confirmationModal"),this.balance=0,this.tableConfig={columns:[{title:"amount",dataField:"amount",type:"price"},{title:"type",dataField:"type_status"},{title:"remark",dataField:"detail"},{title:"created_at",dataField:"created_at",type:"date"}],data:[],total:0};let t=p(I);this.isBrowser=L(t),this.store.selectSnapshot(e=>e.account.roleName!=="vendor")&&this.store.dispatch(new he({role:"vendor",status:1})),this.form=this.formBuilder.group({vendor_id:new F("",[W.required]),balance:new F("",[W.required])}),this.store.selectSnapshot(e=>e.account.roleName!=="vendor")?this.form.controls.vendor_id.valueChanges.subscribe(e=>{e&&(this.paginateInitialData.vendor_id=e,this.store.dispatch(new y(this.paginateInitialData)),this.transactions())}):(this.store.dispatch(new y),this.transactions())}transactions(){this.vendorWallet$.subscribe(t=>{let e=t?.transactions?.data?.filter(i=>(i.type_status=i.type?`<div class="status-${i.type}"><span>${i.type.replace(/_/g," ")}</span></div>`:"-",i));this.balance=t?t?.balance:0,this.tableConfig.data=t?e:[],this.tableConfig.total=t?t?.transactions?.total:0}),this.renderer.addClass(this.document.body,"loader-none")}onTableChange(t){this.paginateInitialData=t;let e=this.form.controls.vendor_id?.value;this.paginateInitialData.vendor_id=e,e&&this.store.dispatch(new y(this.paginateInitialData))}submit(t){this.form.markAllAsTouched();let e=new be(this.form.value);t=="debit"&&(e=new ge(this.form.value)),this.form.valid&&this.store.dispatch(e).subscribe({complete:()=>{this.form.controls.balance.reset()}})}ngOnDestroy(){this.renderer.removeClass(this.document.body,"loader-none")}};m.\u0275fac=function(e){return new(e||m)},m.\u0275cmp=$({type:m,selectors:[["app-vendor-wallet"]],viewQuery:function(e,i){e&1&&O(i.ConfirmationModal,we,5),e&2&&q()},decls:23,vars:21,consts:[["confirmationModal",""],["bal",""],[1,"row","g-0"],[1,"col-xxl-4","col-xl-5"],[3,"ngClass"],[3,"formGroup"],[3,"gridClass","title"],[1,"wallet-sec","theme-form"],[1,"wallet-amount"],[1,"wallet-icon"],[1,"ri-wallet-line"],[4,"hasPermission"],[3,"tableChanged","dateRange","tableConfig"],[3,"confirmed"],["formControlName","vendor_id",1,"custom-select",3,"data","placeholder","noResultMessage"],["type","number","formControlName","balance","numbersOnly","",1,"form-control",3,"placeholder"],[1,"btn-sec"],[3,"click","disabled","spinner"],[3,"click","spinner","disabled"]],template:function(e,i){if(e&1){let A=S();d(0,"div",2),w(1,Me,4,4,"div",3),r(2,"async"),d(3,"div",4),r(4,"async"),d(5,"form",5)(6,"app-page-wrapper",6)(7,"div",7)(8,"div",8)(9,"div",9),C(10,"i",10),c(),d(11,"div")(12,"h2"),b(13),r(14,"currencySymbol"),c(),d(15,"h5"),b(16),r(17,"translate"),c()()(),k(18,Be,11,18,"ng-container",11),c()()()()(),d(19,"app-page-wrapper",6)(20,"app-table",12),v("tableChanged",function(g){return _(A),h(i.onTableChange(g))}),c()(),d(21,"app-confirmation-modal",13,0),v("confirmed",function(g){return _(A),h(i.submit(g==null?null:g.actionToPerform))}),c()}e&2&&(n(),x(l(2,12,i.roleName$)!=="vendor"?1:-1),n(2),a("ngClass",l(4,14,i.roleName$)!=="vendor"?"col-xxl-8 col-xl-7":"col-xxl-12 col-xl-12"),n(2),a("formGroup",i.form),n(),a("gridClass","col-sm-12")("title","wallet"),n(7),B(l(14,16,i.balance)),n(3),B(l(17,18,"wallet_balance")),n(2),a("hasPermission",D(20,xe)),n(),a("gridClass","col-sm-12")("title","transactions"),n(),a("dateRange",!0)("tableConfig",i.tableConfig))},dependencies:[H,U,oe,ie,X,z,Y,J,K,ne,Z,ee,_e,se,le,de,fe,me,ue,j,ae,pe],encapsulation:2});let o=m;return o})();export{Ye as VendorWallet};
